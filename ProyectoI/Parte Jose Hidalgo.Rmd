---
title: "Intervalos de Confianza"
authors: "David González Agüero, José Luis Ramírez Hernández, José Pablo Espinoza López, José Carlo Hidalgo Chacón."
date: "30/3/2022"
output:
  word_document: default
  html_document: default
---

```{r include=FALSE}
library(readxl) #Paquete para leer archivo de excel xlsx
library(EnvStats)
library(stests) #Paquete#3 que contiene función z.test para IC Dist Z
library(ggplot2)
require(nortest)

if (!require('devtools')) install.packages('devtools')
devtools::install_github('fhernanb/stests', force=TRUE)
```

```{r include=FALSE}
#Se carga la base de datos. Se almacena la variable Elecciones para ser manipulada.
Elecciones <- read_excel("Datos/Elecciones.xlsx")
```

**Pruebas de hipótesis para de una varianza utlizando una población**

#Mujeres que tengan un salario mensual mayor a 200000.
***Población***
```{r}
salarioMujer <- Elecciones[Elecciones$sexo=="Mujer" & Elecciones$salarioMes >= 200000,]$salarioMes
salarioMujer <- as.numeric(salarioMujer)
salarioMujer <- na.omit(salarioMujer)
salarioMujer

```
Se quiere analizar el salario de las mujeres votantes que tengan que este sea igual o supere los 200000 en el período que la encuenta fué realizada 2021.

Se asumeque la muestra proviene de una población normal

**Hipótesis**

Se plantea comprobar el siguiente grupo de hipótesis.

  $H_{0}:sigma _{2} \leq 1
  
  $H_{1}:sigma _{2} > 1


```{r}
var.test(salarioMujer, alternative='greater',
         null.value=40, conf.level=0.95)
```


Dado a que el p-value es mayor que el nivel de significancia 5%, no se rechaza la hipótesis nula. Las evidencias no son suficientes para afirmar que la varianza del proceso de llenado es mayor que 1.





# Pruebas de hipótesis para el cociente de varianzas con dos poblaciones.


**Poblaciones**


**Población de la edad de todas las mujeres:**

```{r echo=FALSE}
MujeresEdad <- Elecciones[Elecciones$sexo == "Mujer" & Elecciones$estudios == "Universidad completa" ,]$edad
MujeresEdad
```

**Población de la edad de todos los hombres:**
```{r echo=FALSE}
HombresEdad <- Elecciones[Elecciones$sexo == "Hombre" & Elecciones$estudios == "Universidad completa" ,]$edad
HombresEdad
```
  

```{r include=FALSE}
set.seed(1000)
MujeresEdad.elegidas <- sample(1:length(MujeresEdad),30,replace = TRUE)

```
**Muestra de la edad de las mujeres:**
```{r echo=FALSE}
muestra.MujeresEdad <- MujeresEdad[MujeresEdad.elegidas]
muestra.MujeresEdad
```

```{r include=FALSE}
set.seed(1000)
HombresEdad.elegidos<- sample(1:length(HombresEdad),30,replace = TRUE)

```
**Muestra de la edad de los hombres:**
```{r echo=FALSE}
muestra.HombresEdad <- HombresEdad[HombresEdad.elegidos]
muestra.HombresEdad
```

Se tiene dos poblaciones que las define la edad de las mujeres y hombres con estudios universitarios que participan en la política.

Se plantea comprobarel siguiente grupo de hipótesis.

**Dos Colas**
  $H_{0}:sigma _{2}^{2} = \sigma_{1}^{2}
  
  $H_{1}:sigma _{2}^{2} \neq \sigma_{1}^{2}


***Valor Critico***

  $F_1-\alpha 
  
```{r echo=FALSE}
q1 <- qqnorm(muestra.MujeresEdad, plot.it=FALSE)
q2 <- qqnorm(muestra.HombresEdad, plot.it=FALSE)
plot(range(q1$x, q2$x), range(q1$y, q2$y), type="n", las=1,
     xlab='Theoretical Quantiles', ylab='Sample Quantiles')
points(q1, pch=19)
points(q2, col="red", pch=19)
qqline(muestra.MujeresEdad, lty='dashed')
qqline(muestra.HombresEdad, col="red", lty="dashed")
legend('topleft', legend=c('Mujeres con estudios universitarios', 'Hombres con estudios universitarios'), bty='n',
       col=c('black', 'red'), pch=19)

```
```{r echo=FALSE}
require(nortest)  # Se necesita tener instalado
```


#Prueba
**Prueba de hipotesis $H_0**
La función var.test se Utiliza para probar $H_0.


```{r echo=FALSE}
var.test(muestra.MujeresEdad, muestra.HombresEdad, null.value=1, alternative="two.sided",
         conf.level=0.95)
```
Como el  p-value es 0.3668, se puede concluir que las varianzas son similares.


